<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEN-AI ë”¥ ë¦¬ì„œì¹˜ ìº”ë²„ìŠ¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background-color: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background-color: #a7a7a7; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background-color: #8c8c8c; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #6366f1; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #generateBtn:disabled, #modifyBtn:disabled { cursor: not-allowed; opacity: 0.7; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        .animate-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        .post-stage { border-left: 3px solid #ddd; padding-left: 1.5rem; position: relative; }
        .post-stage::before { content: attr(data-stage); position: absolute; left: -14px; top: -2px; background-color: #a78bfa; color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; font-weight: bold; }
        .post-stage h4 { color: #8b5cf6; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div id="login-screen" class="flex items-center justify-center min-h-screen">
        <div class="w-full max-w-sm bg-white p-8 rounded-2xl shadow-lg border border-gray-200 text-center mx-4">
            <h1 class="text-2xl font-bold text-gray-800 mb-4">ğŸš€ GEN-AI ë”¥ ë¦¬ì„œì¹˜</h1>
            <p class="text-gray-500 mb-6">ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹œë ¤ë©´ ì§„ì…ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            <input type="password" id="login-code" class="w-full px-4 py-3 text-center bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
            <p id="login-error" class="text-red-500 text-sm mt-2 h-5"></p>
            <button id="login-btn" class="w-full mt-2 bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-all duration-300">ì…ì¥í•˜ê¸°</button>
        </div>
    </div>

    <div id="main-app" class="hidden">
        <div class="container mx-auto p-4 md:p-8">
            <header class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-gray-800">ğŸš€ GEN-AI ë”¥ ë¦¬ì„œì¹˜ ìº”ë²„ìŠ¤</h1>
                <p class="text-gray-500 mt-2">ì½˜í…ì¸  ì…ë ¥ ì‹œ AIê°€ ì‹¬ì¸µ ë¶„ì„í•˜ì—¬ í•˜ë‚˜ì˜ ì™„ì„±ëœ ê²Œì‹œë¬¼ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
            </header>

            <div class="flex flex-col lg:flex-row gap-8">
                <div class="lg:w-1/3 bg-white p-6 rounded-2xl shadow-lg border border-gray-200 h-fit">
                    <h2 class="text-xl font-semibold mb-4 border-b pb-2">1. ì›ë³¸ ì½˜í…ì¸  ì…ë ¥</h2>
                    <div>
                        <label for="topic" class="block text-sm font-medium text-gray-600">ì£¼ì œ, ì•„ì´ë””ì–´, ê°•ì˜ ëŒ€ë³¸ ë“± ì›ë³¸ ì½˜í…ì¸ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</label>
                        <textarea id="topic" rows="8" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="ì—¬ê¸°ì— ë¶„ì„ì„ ì›í•˜ëŠ” ê¸´ ê¸€ì´ë‚˜ í•µì‹¬ ì£¼ì œë¥¼ ì…ë ¥í•˜ì„¸ìš”. AIê°€ ê¹Šì´ ìˆê²Œ ë¶„ì„í•˜ì—¬ ì½˜í…ì¸ ë¥¼ ì¬ì°½ì¡°í•©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="mt-6 flex gap-2">
                        <button id="resetBtn" class="w-1/3 bg-gray-200 text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 transition-all duration-300">ì´ˆê¸°í™”</button>
                        <button id="generateBtn" class="w-2/3 bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-300 shadow-md flex items-center justify-center gap-2">
                            <span>ì½˜í…ì¸  ìƒì„± ì‹œì‘</span>
                        </button>
                    </div>
                </div>

                <div id="canvas" class="lg:w-2/3 space-y-6">
                    <div id="initial-placeholder" class="bg-white p-6 rounded-2xl shadow-lg border border-gray-200 text-center h-full flex items-center justify-center min-h-[300px]">
                        <p class="text-gray-500">ì™¼ìª½ì— ì½˜í…ì¸ ë¥¼ ì…ë ¥í•˜ê³  ë²„íŠ¼ì„ ëˆ„ë¥´ë©´<br>AI ë”¥ ë¦¬ì„œì¹˜ ë° ì½˜í…ì¸  ìƒì„±ì´ ì‹œì‘ë©ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-10 right-10 bg-green-500 text-white py-2 px-4 rounded-lg shadow-xl transition-opacity duration-300 opacity-0"></div>
    <textarea id="copyBuffer" class="absolute -left-full"></textarea>

    <script>
        // --- Elements ---
        const loginScreen = document.getElementById('login-screen');
        const mainApp = document.getElementById('main-app');
        const loginCodeInput = document.getElementById('login-code');
        const loginBtn = document.getElementById('login-btn');
        const loginError = document.getElementById('login-error');
        const generateBtn = document.getElementById('generateBtn');
        const resetBtn = document.getElementById('resetBtn');
        const canvas = document.getElementById('canvas');
        const topicInput = document.getElementById('topic');
        const initialPlaceholder = document.getElementById('initial-placeholder');
        const toast = document.getElementById('toast');
        const copyBuffer = document.getElementById('copyBuffer');
        const correctCode = 'thread2025';
        
        // --- State ---
        let generatedData = { topic: '' };

        // --- Login ---
        function attemptLogin() {
            if (loginCodeInput.value === correctCode) {
                loginScreen.classList.add('hidden');
                mainApp.classList.remove('hidden');
                mainApp.classList.add('fade-in');
            } else {
                loginError.textContent = 'ì§„ì…ì½”ë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                loginCodeInput.value = '';
                loginCodeInput.focus();
                loginScreen.querySelector('div').classList.add('animate-shake');
                setTimeout(() => { loginScreen.querySelector('div').classList.remove('animate-shake'); }, 500);
            }
        }
        loginBtn.addEventListener('click', attemptLogin);
        loginCodeInput.addEventListener('keyup', (e) => {
            loginError.textContent = '';
            if (e.key === 'Enter') attemptLogin();
        });

        // --- API Call ---
        async function callDeepResearchAPI(topic, modification = "") {
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            const systemPrompt = `ë‹¹ì‹ ì€ ìˆ˜ë§ì€ ì‚¬ëŒë“¤ì˜ ê³ ë¯¼ì„ ë“£ê³  ê³µê°í•˜ë©° ì¸ì‚¬ì´íŠ¸ë¥¼ ì£¼ëŠ” 'ê³µê° ì „ë¬¸ê°€'ì´ì, ìì‹ ì˜ ê²½í—˜ì„ ì§„ì†”í•˜ê²Œ ë…¹ì—¬ë‚´ì–´ ê¹Šì€ ìš¸ë¦¼ì„ ì£¼ëŠ” 'ì½˜í…ì¸  í¬ë¦¬ì—ì´í„°'ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ê¸€ì€ ë‹¨ìˆœí•œ ì •ë³´ ì „ë‹¬ì´ ì•„ë‹ˆë¼, ë”°ëœ»í•œ ê³µê°ê³¼ ë‚ ì¹´ë¡œìš´ ì „ë¬¸ì„±ì„ ë°”íƒ•ìœ¼ë¡œ í•œ 'ê°€ìƒì˜ ê°œì¸ì  ê²½í—˜ë‹´'ì…ë‹ˆë‹¤. ë…ìë“¤ì´ 'ì´ê±° ì™„ì „ ë‚´ ì–˜ê¸°ì¸ë°?'ë¼ê³  ëŠë¼ë©° ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ì— ì™„ì „íˆ ëª°ì…í•˜ê²Œ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì„ë¬´ëŠ” ì£¼ì–´ì§„ ì½˜í…ì¸ ë¥¼ ë¶„ì„í•˜ì—¬, 20-40ëŒ€ í•œêµ­ì¸ë“¤ì„ ìœ„í•œ ë§¤ìš° ì‹ ë¢°ë„ ë†’ì€ ë‹¨ì¼ ì†Œì…œ ë¯¸ë””ì–´ ê²Œì‹œë¬¼ì„ ì‘ì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë°˜ë“œì‹œ ë‹¤ìŒ ì§€ì¹¨ì„ ë”°ë¼ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µì„ ìƒì„±í•´ì£¼ì„¸ìš”.`;
            
            let userQuery;
            if (modification) {
                userQuery = `ê¸°ì¡´ ì½˜í…ì¸  ì£¼ì œ: "${topic}"\nìˆ˜ì • ìš”ì²­: "${modification}"\n\nì´ì „ì— ìƒì„±ëœ ì½˜í…ì¸ ì— ëŒ€í•´ ë‹¤ìŒ ìˆ˜ì • ìš”ì²­ì„ ë°˜ì˜í•˜ì—¬, ë”¥ ë¦¬ì„œì¹˜ ìš”ì•½, 4ë‹¨ê³„ ì¸ì§€ êµ¬ì¡° ê²Œì‹œë¬¼, ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ë¥¼ ë‹¤ì‹œ ìƒì„±í•´ì£¼ì„¸ìš”.`;
            } else {
                userQuery = `ë¶„ì„í•  ì›ë³¸ ì½˜í…ì¸ : "${topic}"\n\nì´ ì½˜í…ì¸ ì— ëŒ€í•œ 'ë”¥ ë¦¬ì„œì¹˜'ë¥¼ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¨ì¼ ê²Œì‹œë¬¼ê³¼ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.`;
            }

            userQuery += `\n\në”¥ ë¦¬ì„œì¹˜ í•„ìˆ˜ í¬í•¨ ìš”ì†Œ:\n1. í•œêµ­ ë¬¸í™”/ì •ì„œì  ë§¥ë½: 20-40ëŒ€ í•œêµ­ì¸ì´ ê¹Šì´ ê³µê°í•  ìˆ˜ ìˆëŠ” ë¬¸í™”ì , ì •ì„œì  í¬ì¸íŠ¸ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.\n2. ì‹¬ë¦¬í•™ì  ë¶„ì„: ì£¼ì œì™€ ê´€ë ¨ëœ ì¸ê°„ì˜ ë³´í¸ì ì¸ ì‹¬ë¦¬ë‚˜ í–‰ë™ íŒ¨í„´ì„ ì„¤ëª…í•˜ì—¬ ì‹ ë¢°ë„ë¥¼ ë†’ì…ë‹ˆë‹¤.\n3. í†µê³„/ë°ì´í„° (ì‹œë®¬ë ˆì´ì…˜): ì£¼ì¥ì„ ë’·ë°›ì¹¨í•  ìˆ˜ ìˆëŠ” (ì‹¤ì œ ë˜ëŠ” ê°€ìƒì˜) í†µê³„ë‚˜ ë°ì´í„°ë¥¼ ì œì‹œí•©ë‹ˆë‹¤.\n\nê²Œì‹œë¬¼ ì‘ì„± ê·œì¹™:\n- ê²Œì‹œë¬¼ í˜•ì‹: ë‹¨ í•˜ë‚˜ì˜ ì•„í‹°í´í˜• ê²Œì‹œë¬¼.\n- ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼ (ë§¤ìš° ì¤‘ìš”): **ë°˜ë“œì‹œ ë‹¹ì‹ ì˜ ê°œì¸ì ì¸ ê²½í—˜ë‹´ í˜•ì‹ìœ¼ë¡œ ê¸€ì„ ì‹œì‘í•˜ê³  ì „ê°œí•´ì•¼ í•©ë‹ˆë‹¤.** 'ë‚´ê°€ ì˜ˆì „ì— OOO ë•Œë¬¸ì— ì •ë§ í˜ë“¤ì—ˆì„ ë•Œê°€ ìˆì—ˆëŠ”ë°,' ì™€ ê°™ì´, ê°€ìƒì˜ ê²½í—˜ì„ ì‹¤ì œì²˜ëŸ¼ ìƒìƒí•˜ê²Œ ë¬˜ì‚¬í•˜ì—¬ ë…ìì˜ ëª°ì…ì„ ìœ ë„í•´ì¤˜.\n- ë¬¸ì²´: **ì „ë¬¸ì„±ê³¼ ìœ„íŠ¸ë¥¼ ê²¸ë¹„í•œ 'ì¹œí•œ ë©˜í† ' ê°™ì€ ë°˜ë§ì²´.** ë…ìì—ê²Œ '~í•œ ì  ì—†ì–´?', '~ì´ì§€ ì•Šì•„?' ê°™ì´ ì§ˆë¬¸ì„ ë˜ì§€ê±°ë‚˜ '~í•´ì•¼ í•´' ê°™ì´ ë¶€ë“œëŸ½ê²Œ ì¡°ì–¸í•˜ëŠ”, ì •ì¤‘í•˜ë©´ì„œë„ ì¹œê·¼í•œ ë°˜ë§ì„ ì‚¬ìš©í•´ì¤˜. ìš”ì¦˜ ìœ í–‰í•˜ëŠ” ì´ëª¨ì§€(âœ¨, ğŸ¤”, ğŸ‘€, ğŸ“Œ ë“±)ë¥¼ ì ì ˆíˆ í™œìš©í•˜ì—¬ ìƒë™ê°ì„ ë”í•´ì¤˜.\n- ì•„ë˜ 4ë‹¨ê³„ ì¸ì§€ êµ¬ì¡°ë¥¼ ë‹¹ì‹ ì˜ ê²½í—˜ë‹´ ì•ˆì— ìì—°ìŠ¤ëŸ½ê²Œ ë…¹ì—¬ë‚´ì•¼ í•©ë‹ˆë‹¤.\n  - 1ë‹¨ê³„ (ê³µê° ë° ë¬¸ì œ ì œê¸°): ë‹¹ì‹ ì˜ ê²½í—˜ì„ í†µí•´ ë…ìê°€ 'ë‚´ ì–˜ê¸°ì–ì•„?'ë¼ê³  ëŠë‚„ë§Œí•œ ìƒí™©ì„ ì œì‹œí•©ë‹ˆë‹¤.\n  - 2ë‹¨ê³„ (ì‹¬ì¸µ ë¶„ì„ ë° ì¸ì‚¬ì´íŠ¸): ê²½í—˜ ì†ì—ì„œ ì–»ì€ ê¹¨ë‹¬ìŒì„ ë”¥ ë¦¬ì„œì¹˜ ê²°ê³¼(ì‹¬ë¦¬í•™, í†µê³„ ë“±)ì™€ ì—°ê²°í•˜ì—¬, ë¬¸ì œì˜ ë³¸ì§ˆì´ë‚˜ ìƒˆë¡œìš´ ê´€ì ì„ ì œì‹œí•©ë‹ˆë‹¤. (ì˜ˆ: 'ê·¸ë•Œ ë‚´ê°€ ëŠê¼ˆë˜ ê°ì •ì´ ì‹¬ë¦¬í•™ì—ì„œ ë§í•˜ëŠ” OOOì˜€ë”ë¼ê³ .')\n  - 3ë‹¨ê³„ (í•´ê²°ì±… ë§›ë³´ê¸°): ê·¸ë˜ì„œ ë‹¹ì‹ ì´ 'ì‹¤ì œë¡œ íš¨ê³¼ë¥¼ ë´¤ë˜' ì‘ì§€ë§Œ ê°•ë ¥í•œ íŒ í•˜ë‚˜ë§Œ ê³µê°œí•˜ì—¬ í˜¸ê¸°ì‹¬ì„ ìê·¹í•©ë‹ˆë‹¤.\n  - 4ë‹¨ê³„ (ê°€ì¹˜ ì œì•ˆ ë° CTA): ë‹¹ì‹ ì˜ ê²½í—˜ë‹´ì´ ì¼ë¶€ì— ë¶ˆê³¼í•˜ë©°, ë” ê·¼ë³¸ì ì¸ í•´ê²°ì±…ì´ ìˆìŒì„ ì•”ì‹œí•˜ë©° ì „ì²´ ê°•ì˜/ê¸€ì„ ë³´ë„ë¡ ìœ ë„í•˜ëŠ” ê°•ë ¥í•œ í–‰ë™ ìœ ë„ ë¬¸êµ¬ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.\n\nì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì¡°ê±´:\n- ê²Œì‹œë¬¼ ì „ì²´ì˜ í•µì‹¬ ë©”ì‹œì§€ë¥¼ í•¨ì¶•í•˜ëŠ” ë‹¨ í•˜ë‚˜ì˜ í”„ë¡¬í”„íŠ¸.\n- ìŠ¤íƒ€ì¼: 'ê°ì„±ì ì´ê³  ë”°ëœ»í•œ í•œêµ­ ì›¹íˆ° ê·¸ë¦¼ì²´'.\n- ì¸ë¬¼: 'í•œêµ­ì¸'.\n- êµ¬ì²´ì ì¸ ìƒí™©, êµ¬ë„, í‘œì • í¬í•¨.\n- ìµœì¢… í”„ë¡¬í”„íŠ¸ëŠ” ì˜ì–´ë¡œ ì‘ì„±.`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            deepResearchSummary: { type: "STRING" },
                            post: {
                                type: "OBJECT",
                                properties: {
                                    stage1: { type: "STRING" },
                                    stage2: { type: "STRING" },
                                    stage3: { type: "STRING" },
                                    stage4: { type: "STRING" }
                                }
                            },
                            imagePrompt: { type: "STRING" }
                        }
                    }
                }
            };
            
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) throw new Error(`API ìš”ì²­ ì‹¤íŒ¨: ${response.status}`);
                const result = await response.json();
                const jsonText = result.candidates[0].content.parts[0].text;
                return JSON.parse(jsonText);
            } catch (error) {
                console.error("API í˜¸ì¶œ ì˜¤ë¥˜:", error);
                return null;
            }
        }
        
        // --- Event Listeners ---
        resetBtn.addEventListener('click', () => {
            topicInput.value = '';
            canvas.innerHTML = '';
            canvas.appendChild(initialPlaceholder);
            generatedData = { topic: '' };
            topicInput.focus();
        });

        generateBtn.addEventListener('click', async () => {
            const topic = topicInput.value;
            if (!topic) {
                alert('ì½˜í…ì¸ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            setLoading(generateBtn, true, 'ìƒì„± ì¤‘...');
            renderLoadingState("AIê°€ ë”¥ ë¦¬ì„œì¹˜ë¥¼ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤... (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)");
            
            const result = await callDeepResearchAPI(topic);

            if (result) {
                generatedData = { topic, ...result };
                renderResult(result);
            } else {
                renderErrorState("ì½˜í…ì¸  ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
            }
            setLoading(generateBtn, false, 'ì½˜í…ì¸  ìƒì„± ì‹œì‘');
        });
        
        // --- Rendering ---
        function renderResult(data) {
            canvas.innerHTML = '';
            
            const researchCard = document.createElement('div');
            researchCard.className = 'fade-in bg-white p-6 rounded-2xl shadow-lg border border-gray-200';
            researchCard.innerHTML = `
                <h3 class="text-xl font-bold text-indigo-600 mb-4">ğŸ”¬ AI ë”¥ ë¦¬ì„œì¹˜ ìš”ì•½</h3>
                <p class="text-gray-700 bg-gray-50 p-4 rounded-lg border">${data.deepResearchSummary}</p>
            `;

            const postCard = document.createElement('div');
            postCard.className = 'fade-in bg-white p-6 rounded-2xl shadow-lg border border-gray-200';
            postCard.innerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-indigo-600">âœï¸ ìƒì„±ëœ ê²Œì‹œë¬¼</h3>
                    <button class="copy-btn bg-gray-200 text-gray-700 text-sm font-semibold px-4 py-1.5 rounded-lg hover:bg-gray-300 transition-colors" data-type="post">ê²Œì‹œë¬¼ ë³µì‚¬</button>
                </div>
                <div class="space-y-8">
                    <div class="post-stage" data-stage="1">
                        <h4 class="font-bold mb-2">1ë‹¨ê³„: ë‚˜ì˜ ê²½í—˜ ê³µìœ  (ê³µê°)</h4>
                        <p class="text-gray-800 whitespace-pre-wrap leading-relaxed">${data.post.stage1}</p>
                    </div>
                    <div class="post-stage" data-stage="2">
                        <h4 class="font-bold mb-2">2ë‹¨ê³„: ê·¸ë•Œì˜ ê¹¨ë‹¬ìŒ (ì¸ì‚¬ì´íŠ¸)</h4>
                        <p class="text-gray-800 whitespace-pre-wrap leading-relaxed">${data.post.stage2}</p>
                    </div>
                    <div class="post-stage" data-stage="3">
                        <h4 class="font-bold mb-2">3ë‹¨ê³„: íš¨ê³¼ ë´¤ë˜ ë°©ë²• (ë§›ë³´ê¸°)</h4>
                        <p class="text-gray-800 whitespace-pre-wrap leading-relaxed">${data.post.stage3}</p>
                    </div>
                    <div class="post-stage" data-stage="4">
                        <h4 class="font-bold mb-2">4ë‹¨ê³„: ë” ê¹Šì€ ì´ì•¼ê¸° (CTA)</h4>
                        <p class="text-gray-800 whitespace-pre-wrap leading-relaxed">${data.post.stage4}</p>
                    </div>
                </div>
            `;
            
            const imageCard = document.createElement('div');
            imageCard.className = 'fade-in bg-white p-6 rounded-2xl shadow-lg border border-gray-200';
            imageCard.innerHTML = `
                 <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-indigo-600">ğŸ¨ ì´ë¯¸ì§€ AI í”„ë¡¬í”„íŠ¸</h3>
                    <button class="copy-btn bg-gray-200 text-gray-700 text-sm font-semibold px-4 py-1.5 rounded-lg hover:bg-gray-300 transition-colors" data-type="prompt">í”„ë¡¬í”„íŠ¸ ë³µì‚¬</button>
                </div>
                <textarea rows="4" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-700 focus:outline-none" readonly>${data.imagePrompt}</textarea>
            `;

            const modificationCard = document.createElement('div');
            modificationCard.className = 'fade-in bg-white p-6 rounded-2xl shadow-lg border border-gray-200';
            modificationCard.innerHTML = `
                <h3 class="text-xl font-bold text-indigo-600 mb-4">ğŸ”„ AIì—ê²Œ ìˆ˜ì • ìš”ì²­í•˜ê¸°</h3>
                <textarea id="modificationPrompt" rows="3" class="w-full p-3 bg-white border border-gray-300 rounded-md text-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="ìˆ˜ì •ì„ ì›í•˜ëŠ” ë‚´ìš©ì„ êµ¬ì²´ì ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ì˜ˆ: ì¢€ ë” ì „ë¬¸ì ì¸ ìš©ì–´ë¥¼ ì‚¬ìš©í•´ì¤˜, CTAë¥¼ ë” ê°•ë ¥í•˜ê²Œ ë°”ê¿”ì¤˜)"></textarea>
                <button id="modifyBtn" class="mt-3 w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-all duration-300 shadow-md flex items-center justify-center gap-2">
                    <span>ì½˜í…ì¸  ìˆ˜ì •í•˜ê¸°</span>
                </button>
            `;

            canvas.appendChild(researchCard);
            canvas.appendChild(postCard);
            canvas.appendChild(imageCard);
            canvas.appendChild(modificationCard);
            
            // Add event listeners
            canvas.querySelectorAll('.copy-btn').forEach(btn => btn.addEventListener('click', handleCopy));
            canvas.querySelector('#modifyBtn').addEventListener('click', handleModification);
        }
        
        function renderLoadingState(message) {
            canvas.innerHTML = `<div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-200 text-center h-full flex flex-col items-center justify-center min-h-[300px]"><div class="loader"></div><p class="text-gray-600 mt-4 font-semibold">${message}</p></div>`;
        }
        
        function renderErrorState(message) {
            canvas.innerHTML = `<div class="bg-white p-6 rounded-2xl shadow-lg border border-red-300 text-center"><p class="text-red-600 font-semibold">${message}</p></div>`;
        }

        // --- Handlers ---
        async function handleModification() {
            const modifyBtn = document.getElementById('modifyBtn');
            const modificationRequest = document.getElementById('modificationPrompt').value;
            if (!modificationRequest) {
                alert('ìˆ˜ì • ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            setLoading(modifyBtn, true, 'ìˆ˜ì • ì¤‘...');
            renderLoadingState("AIê°€ ìš”ì²­ì‚¬í•­ì„ ë°˜ì˜í•˜ì—¬ ì½˜í…ì¸ ë¥¼ ì¬êµ¬ì„± ì¤‘ì…ë‹ˆë‹¤...");
            
            const result = await callDeepResearchAPI(generatedData.topic, modificationRequest);

            if (result) {
                generatedData = { topic: generatedData.topic, ...result };
                renderResult(result);
            } else {
                renderErrorState("ì½˜í…ì¸  ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
            }
        }

        function handleCopy(e) {
            const type = e.target.dataset.type;
            if (type === 'post') {
                const postText = Object.values(generatedData.post).join('\n\n---\n\n');
                copyToClipboard(postText, 'ê²Œì‹œë¬¼ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } else if (type === 'prompt') {
                copyToClipboard(generatedData.imagePrompt, 'ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        }
        
        // --- Utilities ---
        function copyToClipboard(text, message) {
            copyBuffer.value = text;
            copyBuffer.select();
            document.execCommand('copy');
            showToast(message);
        }

        function setLoading(button, isLoading, text) {
            button.disabled = isLoading;
            button.innerHTML = isLoading ? `<div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div><span>${text}</span>` : `<span>${text}</span>`;
        }
        
        function showToast(message) {
            toast.textContent = message;
            toast.classList.remove('opacity-0');
            setTimeout(() => { toast.classList.add('opacity-0'); }, 2000);
        }
    </script>
</body>
</html>

